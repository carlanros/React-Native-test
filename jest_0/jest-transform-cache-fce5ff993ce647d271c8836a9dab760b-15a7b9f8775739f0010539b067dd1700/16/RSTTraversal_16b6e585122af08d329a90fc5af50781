2896d5ba11e4c8cb94b7aded8d4b53a7
Object.defineProperty(exports,"__esModule",{value:true});exports.nodeHasProperty=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[typeof Symbol==="function"?Symbol.iterator:"@@iterator"](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if((typeof Symbol==="function"?Symbol.iterator:"@@iterator")in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();exports.propsOfNode=propsOfNode;exports.childrenOfNode=childrenOfNode;exports.hasClassName=hasClassName;exports.treeForEach=treeForEach;exports.treeFilter=treeFilter;exports.findParentNode=findParentNode;exports.pathToNode=pathToNode;exports.parentsOfNode=parentsOfNode;exports.nodeHasId=nodeHasId;exports.nodeMatchesObjectProps=nodeMatchesObjectProps;exports.getTextFromNode=getTextFromNode;var _object=require("object.assign");var _object2=_interopRequireDefault(_object);var _flatten=require("lodash/flatten");var _flatten2=_interopRequireDefault(_flatten);var _object3=require("object.entries");var _object4=_interopRequireDefault(_object3);var _isSubset=require("is-subset");var _isSubset2=_interopRequireDefault(_isSubset);var _functionPrototype=require("function.prototype.name");var _functionPrototype2=_interopRequireDefault(_functionPrototype);var _Utils=require('./Utils');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{'default':obj};}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function propsOfNode(node){return node&&node.props||{};}function childrenOfNode(node){if(!node)return[];return Array.isArray(node.rendered)?(0,_flatten2['default'])(node.rendered,true):[node.rendered];}function hasClassName(node,className){var classes=propsOfNode(node).className||'';classes=String(classes).replace(/\s/g,' ');return(' '+String(classes)+' ').indexOf(' '+String(className)+' ')>-1;}function treeForEach(tree,fn){if(tree!==null&&tree!==false&&typeof tree!=='undefined'){fn(tree);}childrenOfNode(tree).forEach(function(node){return treeForEach(node,fn);});}function treeFilter(tree,fn){var results=[];treeForEach(tree,function(node){if(fn(node)){results.push(node);}});return results;}function findParentNode(root,targetNode){var results=treeFilter(root,function(node){if(!node.rendered){return false;}return Array.isArray(node.rendered)?node.rendered.indexOf(targetNode)!==-1:node.rendered===targetNode;});return results[0]||null;}function pathFilter(path,fn){return path.filter(function(tree){return treeFilter(tree,fn).length!==0;});}function pathToNode(node,root){var queue=[root];var path=[];var hasNode=function hasNode(testNode){return node===testNode;};while(queue.length){var current=queue.pop();var children=childrenOfNode(current);if(current===node)return pathFilter(path,hasNode);path.push(current);if(children.length===0){path.pop();}queue.push.apply(queue,_toConsumableArray(children));}return null;}function parentsOfNode(node,root){return pathToNode(node,root).reverse();}function nodeHasId(node,id){return propsOfNode(node).id===id;}exports.nodeHasProperty=_Utils.nodeHasProperty;var CAN_NEVER_MATCH={};function replaceUndefined(v){return typeof v!=='undefined'?v:CAN_NEVER_MATCH;}function replaceUndefinedValues(obj){return(0,_object4['default'])(obj).reduce(function(acc,_ref){var _ref2=_slicedToArray(_ref,2),k=_ref2[0],v=_ref2[1];return(0,_object2['default'])({},acc,_defineProperty({},k,replaceUndefined(v)));},{});}function nodeMatchesObjectProps(node,props){return(0,_isSubset2['default'])(propsOfNode(node),replaceUndefinedValues(props));}function getTextFromNode(node){if(node==null){return'';}if(typeof node==='string'||typeof node==='number'){return String(node);}if(node.type&&typeof node.type==='function'){return'<'+String(node.type.displayName||(0,_functionPrototype2['default'])(node.type))+' />';}return childrenOfNode(node).map(getTextFromNode).join('');}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJTVFRyYXZlcnNhbC5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIm5vZGVIYXNQcm9wZXJ0eSIsInVuZGVmaW5lZCIsIl9zbGljZWRUb0FycmF5Iiwic2xpY2VJdGVyYXRvciIsImFyciIsImkiLCJfYXJyIiwiX24iLCJfZCIsIl9lIiwiX2kiLCJTeW1ib2wiLCJpdGVyYXRvciIsIl9zIiwibmV4dCIsImRvbmUiLCJwdXNoIiwibGVuZ3RoIiwiZXJyIiwiQXJyYXkiLCJpc0FycmF5IiwiVHlwZUVycm9yIiwicHJvcHNPZk5vZGUiLCJjaGlsZHJlbk9mTm9kZSIsImhhc0NsYXNzTmFtZSIsInRyZWVGb3JFYWNoIiwidHJlZUZpbHRlciIsImZpbmRQYXJlbnROb2RlIiwicGF0aFRvTm9kZSIsInBhcmVudHNPZk5vZGUiLCJub2RlSGFzSWQiLCJub2RlTWF0Y2hlc09iamVjdFByb3BzIiwiZ2V0VGV4dEZyb21Ob2RlIiwiX29iamVjdCIsInJlcXVpcmUiLCJfb2JqZWN0MiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfZmxhdHRlbiIsIl9mbGF0dGVuMiIsIl9vYmplY3QzIiwiX29iamVjdDQiLCJfaXNTdWJzZXQiLCJfaXNTdWJzZXQyIiwiX2Z1bmN0aW9uUHJvdG90eXBlIiwiX2Z1bmN0aW9uUHJvdG90eXBlMiIsIl9VdGlscyIsIm9iaiIsIl9fZXNNb2R1bGUiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIyIiwiZnJvbSIsIm5vZGUiLCJwcm9wcyIsInJlbmRlcmVkIiwiY2xhc3NOYW1lIiwiY2xhc3NlcyIsIlN0cmluZyIsInJlcGxhY2UiLCJpbmRleE9mIiwidHJlZSIsImZuIiwiZm9yRWFjaCIsInJlc3VsdHMiLCJyb290IiwidGFyZ2V0Tm9kZSIsInBhdGhGaWx0ZXIiLCJwYXRoIiwiZmlsdGVyIiwicXVldWUiLCJoYXNOb2RlIiwidGVzdE5vZGUiLCJjdXJyZW50IiwicG9wIiwiY2hpbGRyZW4iLCJhcHBseSIsInJldmVyc2UiLCJpZCIsIkNBTl9ORVZFUl9NQVRDSCIsInJlcGxhY2VVbmRlZmluZWQiLCJ2IiwicmVwbGFjZVVuZGVmaW5lZFZhbHVlcyIsInJlZHVjZSIsImFjYyIsIl9yZWYiLCJfcmVmMiIsImsiLCJ0eXBlIiwiZGlzcGxheU5hbWUiLCJtYXAiLCJqb2luIl0sIm1hcHBpbmdzIjoiQUFBQUEsT0FBT0MsY0FBUCxDQUFzQkMsT0FBdEIsQ0FBK0IsWUFBL0IsQ0FBNkMsQ0FDM0NDLE1BQU8sSUFEb0MsQ0FBN0MsRUFHQUQsUUFBUUUsZUFBUixDQUEwQkMsU0FBMUIsQ0FFQSxHQUFJQyxnQkFBaUIsVUFBWSxDQUFFLFFBQVNDLGNBQVQsQ0FBdUJDLEdBQXZCLENBQTRCQyxDQUE1QixDQUErQixDQUFFLEdBQUlDLE1BQU8sRUFBWCxDQUFlLEdBQUlDLElBQUssSUFBVCxDQUFlLEdBQUlDLElBQUssS0FBVCxDQUFnQixHQUFJQyxJQUFLUixTQUFULENBQW9CLEdBQUksQ0FBRSxJQUFLLEdBQUlTLElBQUtOLCtCQUFJTyxPQUFPQyxRQUFYLGdCQUFULENBQWlDQyxFQUF0QyxDQUEwQyxFQUFFTixHQUFLLENBQUNNLEdBQUtILEdBQUdJLElBQUgsRUFBTixFQUFpQkMsSUFBeEIsQ0FBMUMsQ0FBeUVSLEdBQUssSUFBOUUsQ0FBb0YsQ0FBRUQsS0FBS1UsSUFBTCxDQUFVSCxHQUFHZCxLQUFiLEVBQXFCLEdBQUlNLEdBQUtDLEtBQUtXLE1BQUwsR0FBZ0JaLENBQXpCLENBQTRCLE1BQVEsQ0FBRSxDQUFDLE1BQU9hLEdBQVAsQ0FBWSxDQUFFVixHQUFLLElBQUwsQ0FBV0MsR0FBS1MsR0FBTCxDQUFXLENBQTVMLE9BQXFNLENBQUUsR0FBSSxDQUFFLEdBQUksQ0FBQ1gsRUFBRCxFQUFPRyxHQUFHLFFBQUgsQ0FBWCxDQUF5QkEsR0FBRyxRQUFILElBQWlCLENBQWhE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dCI6WyJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5ub2RlSGFzUHJvcGVydHkgPSB1bmRlZmluZWQ7XG5cbnZhciBfc2xpY2VkVG9BcnJheSA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gc2xpY2VJdGVyYXRvcihhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0pIF9pW1wicmV0dXJuXCJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfSByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IHJldHVybiBhcnI7IH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7IHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7IH0gZWxzZSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlXCIpOyB9IH07IH0oKTtcblxuZXhwb3J0cy5wcm9wc09mTm9kZSA9IHByb3BzT2ZOb2RlO1xuZXhwb3J0cy5jaGlsZHJlbk9mTm9kZSA9IGNoaWxkcmVuT2ZOb2RlO1xuZXhwb3J0cy5oYXNDbGFzc05hbWUgPSBoYXNDbGFzc05hbWU7XG5leHBvcnRzLnRyZWVGb3JFYWNoID0gdHJlZUZvckVhY2g7XG5leHBvcnRzLnRyZWVGaWx0ZXIgPSB0cmVlRmlsdGVyO1xuZXhwb3J0cy5maW5kUGFyZW50Tm9kZSA9IGZpbmRQYXJlbnROb2RlO1xuZXhwb3J0cy5wYXRoVG9Ob2RlID0gcGF0aFRvTm9kZTtcbmV4cG9ydHMucGFyZW50c09mTm9kZSA9IHBhcmVudHNPZk5vZGU7XG5leHBvcnRzLm5vZGVIYXNJZCA9IG5vZGVIYXNJZDtcbmV4cG9ydHMubm9kZU1hdGNoZXNPYmplY3RQcm9wcyA9IG5vZGVNYXRjaGVzT2JqZWN0UHJvcHM7XG5leHBvcnRzLmdldFRleHRGcm9tTm9kZSA9IGdldFRleHRGcm9tTm9kZTtcblxudmFyIF9vYmplY3QgPSByZXF1aXJlKCdvYmplY3QuYXNzaWduJyk7XG5cbnZhciBfb2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29iamVjdCk7XG5cbnZhciBfZmxhdHRlbiA9IHJlcXVpcmUoJ2xvZGFzaC9mbGF0dGVuJyk7XG5cbnZhciBfZmxhdHRlbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mbGF0dGVuKTtcblxudmFyIF9vYmplY3QzID0gcmVxdWlyZSgnb2JqZWN0LmVudHJpZXMnKTtcblxudmFyIF9vYmplY3Q0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2JqZWN0Myk7XG5cbnZhciBfaXNTdWJzZXQgPSByZXF1aXJlKCdpcy1zdWJzZXQnKTtcblxudmFyIF9pc1N1YnNldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pc1N1YnNldCk7XG5cbnZhciBfZnVuY3Rpb25Qcm90b3R5cGUgPSByZXF1aXJlKCdmdW5jdGlvbi5wcm90b3R5cGUubmFtZScpO1xuXG52YXIgX2Z1bmN0aW9uUHJvdG90eXBlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Z1bmN0aW9uUHJvdG90eXBlKTtcblxudmFyIF9VdGlscyA9IHJlcXVpcmUoJy4vVXRpbHMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxuZnVuY3Rpb24gcHJvcHNPZk5vZGUobm9kZSkge1xuICByZXR1cm4gbm9kZSAmJiBub2RlLnByb3BzIHx8IHt9O1xufVxuXG5mdW5jdGlvbiBjaGlsZHJlbk9mTm9kZShub2RlKSB7XG4gIGlmICghbm9kZSkgcmV0dXJuIFtdO1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShub2RlLnJlbmRlcmVkKSA/ICgwLCBfZmxhdHRlbjJbJ2RlZmF1bHQnXSkobm9kZS5yZW5kZXJlZCwgdHJ1ZSkgOiBbbm9kZS5yZW5kZXJlZF07XG59XG5cbmZ1bmN0aW9uIGhhc0NsYXNzTmFtZShub2RlLCBjbGFzc05hbWUpIHtcbiAgdmFyIGNsYXNzZXMgPSBwcm9wc09mTm9kZShub2RlKS5jbGFzc05hbWUgfHwgJyc7XG4gIGNsYXNzZXMgPSBTdHJpbmcoY2xhc3NlcykucmVwbGFjZSgvXFxzL2csICcgJyk7XG4gIHJldHVybiAoJyAnICsgU3RyaW5nKGNsYXNzZXMpICsgJyAnKS5pbmRleE9mKCcgJyArIFN0cmluZyhjbGFzc05hbWUpICsgJyAnKSA+IC0xO1xufVxuXG5mdW5jdGlvbiB0cmVlRm9yRWFjaCh0cmVlLCBmbikge1xuICBpZiAodHJlZSAhPT0gbnVsbCAmJiB0cmVlICE9PSBmYWxzZSAmJiB0eXBlb2YgdHJlZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBmbih0cmVlKTtcbiAgfVxuICBjaGlsZHJlbk9mTm9kZSh0cmVlKS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgcmV0dXJuIHRyZWVGb3JFYWNoKG5vZGUsIGZuKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHRyZWVGaWx0ZXIodHJlZSwgZm4pIHtcbiAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgdHJlZUZvckVhY2godHJlZSwgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICBpZiAoZm4obm9kZSkpIHtcbiAgICAgIHJlc3VsdHMucHVzaChub2RlKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLyoqXG4gKiBUbyBzdXBwb3J0IHNpYmxpbmcgc2VsZWN0b3JzIHdlIG5lZWQgdG8gYmUgYWJsZSB0byBmaW5kXG4gKiB0aGUgc2libGluZ3Mgb2YgYSBub2RlLiBUaGUgZWFzaWVzdCB3YXkgdG8gZG8gdGhhdCBpcyBmaW5kXG4gKiB0aGUgcGFyZW50IG9mIHRoZSBub2RlIGFuZCBhY2Nlc3MgaXRzIGNoaWxkcmVuLlxuICpcbiAqIFRoaXMgd291bGQgYmUgdW5uZWVkZWQgaWYgdGhlIFJTVCBzcGVjIGluY2x1ZGVkIHNpYmxpbmcgcG9pbnRlcnNcbiAqIHN1Y2ggYXMgbm9kZS5uZXh0U2libGluZyBhbmQgbm9kZS5wcmV2U2libGluZ1xuICogQHBhcmFtIHsqfSByb290XG4gKiBAcGFyYW0geyp9IHRhcmdldE5vZGVcbiAqL1xuZnVuY3Rpb24gZmluZFBhcmVudE5vZGUocm9vdCwgdGFyZ2V0Tm9kZSkge1xuICB2YXIgcmVzdWx0cyA9IHRyZWVGaWx0ZXIocm9vdCwgZnVuY3Rpb24gKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUucmVuZGVyZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkobm9kZS5yZW5kZXJlZCkgPyBub2RlLnJlbmRlcmVkLmluZGV4T2YodGFyZ2V0Tm9kZSkgIT09IC0xIDogbm9kZS5yZW5kZXJlZCA9PT0gdGFyZ2V0Tm9kZTtcbiAgfSk7XG4gIHJldHVybiByZXN1bHRzWzBdIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIHBhdGhGaWx0ZXIocGF0aCwgZm4pIHtcbiAgcmV0dXJuIHBhdGguZmlsdGVyKGZ1bmN0aW9uICh0cmVlKSB7XG4gICAgcmV0dXJuIHRyZWVGaWx0ZXIodHJlZSwgZm4pLmxlbmd0aCAhPT0gMDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhdGhUb05vZGUobm9kZSwgcm9vdCkge1xuICB2YXIgcXVldWUgPSBbcm9vdF07XG4gIHZhciBwYXRoID0gW107XG5cbiAgdmFyIGhhc05vZGUgPSBmdW5jdGlvbiBoYXNOb2RlKHRlc3ROb2RlKSB7XG4gICAgcmV0dXJuIG5vZGUgPT09IHRlc3ROb2RlO1xuICB9O1xuXG4gIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcbiAgICB2YXIgY3VycmVudCA9IHF1ZXVlLnBvcCgpO1xuICAgIHZhciBjaGlsZHJlbiA9IGNoaWxkcmVuT2ZOb2RlKGN1cnJlbnQpO1xuICAgIGlmIChjdXJyZW50ID09PSBub2RlKSByZXR1cm4gcGF0aEZpbHRlcihwYXRoLCBoYXNOb2RlKTtcblxuICAgIHBhdGgucHVzaChjdXJyZW50KTtcblxuICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIGxlYWYgbm9kZS4gaWYgaXQgaXNuJ3QgdGhlIG5vZGUgd2UgYXJlIGxvb2tpbmcgZm9yLCB3ZSBwb3AuXG4gICAgICBwYXRoLnBvcCgpO1xuICAgIH1cbiAgICBxdWV1ZS5wdXNoLmFwcGx5KHF1ZXVlLCBfdG9Db25zdW1hYmxlQXJyYXkoY2hpbGRyZW4pKTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBwYXJlbnRzT2ZOb2RlKG5vZGUsIHJvb3QpIHtcbiAgcmV0dXJuIHBhdGhUb05vZGUobm9kZSwgcm9vdCkucmV2ZXJzZSgpO1xufVxuXG5mdW5jdGlvbiBub2RlSGFzSWQobm9kZSwgaWQpIHtcbiAgcmV0dXJuIHByb3BzT2ZOb2RlKG5vZGUpLmlkID09PSBpZDtcbn1cblxuZXhwb3J0cy5ub2RlSGFzUHJvcGVydHkgPSBfVXRpbHMubm9kZUhhc1Byb3BlcnR5O1xuXG5cbnZhciBDQU5fTkVWRVJfTUFUQ0ggPSB7fTtcbmZ1bmN0aW9uIHJlcGxhY2VVbmRlZmluZWQodikge1xuICByZXR1cm4gdHlwZW9mIHYgIT09ICd1bmRlZmluZWQnID8gdiA6IENBTl9ORVZFUl9NQVRDSDtcbn1cbmZ1bmN0aW9uIHJlcGxhY2VVbmRlZmluZWRWYWx1ZXMob2JqKSB7XG4gIHJldHVybiAoMCwgX29iamVjdDRbJ2RlZmF1bHQnXSkob2JqKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgX3JlZikge1xuICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDIpLFxuICAgICAgICBrID0gX3JlZjJbMF0sXG4gICAgICAgIHYgPSBfcmVmMlsxXTtcblxuICAgIHJldHVybiAoMCwgX29iamVjdDJbJ2RlZmF1bHQnXSkoe30sIGFjYywgX2RlZmluZVByb3BlcnR5KHt9LCBrLCByZXBsYWNlVW5kZWZpbmVkKHYpKSk7XG4gIH0sIHt9KTtcbn1cblxuZnVuY3Rpb24gbm9kZU1hdGNoZXNPYmplY3RQcm9wcyhub2RlLCBwcm9wcykge1xuICByZXR1cm4gKDAsIF9pc1N1YnNldDJbJ2RlZmF1bHQnXSkocHJvcHNPZk5vZGUobm9kZSksIHJlcGxhY2VVbmRlZmluZWRWYWx1ZXMocHJvcHMpKTtcbn1cblxuZnVuY3Rpb24gZ2V0VGV4dEZyb21Ob2RlKG5vZGUpIHtcbiAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICh0eXBlb2Ygbm9kZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIG5vZGUgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIFN0cmluZyhub2RlKTtcbiAgfVxuXG4gIGlmIChub2RlLnR5cGUgJiYgdHlwZW9mIG5vZGUudHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiAnPCcgKyBTdHJpbmcobm9kZS50eXBlLmRpc3BsYXlOYW1lIHx8ICgwLCBfZnVuY3Rpb25Qcm90b3R5cGUyWydkZWZhdWx0J10pKG5vZGUudHlwZSkpICsgJyAvPic7XG4gIH1cblxuICByZXR1cm4gY2hpbGRyZW5PZk5vZGUobm9kZSkubWFwKGdldFRleHRGcm9tTm9kZSkuam9pbignJyk7XG59Il19