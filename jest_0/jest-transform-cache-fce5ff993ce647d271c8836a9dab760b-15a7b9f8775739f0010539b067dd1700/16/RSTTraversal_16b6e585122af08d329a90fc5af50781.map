{"version":3,"sources":["RSTTraversal.js"],"names":["Object","defineProperty","exports","value","nodeHasProperty","undefined","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","propsOfNode","childrenOfNode","hasClassName","treeForEach","treeFilter","findParentNode","pathToNode","parentsOfNode","nodeHasId","nodeMatchesObjectProps","getTextFromNode","_object","require","_object2","_interopRequireDefault","_flatten","_flatten2","_object3","_object4","_isSubset","_isSubset2","_functionPrototype","_functionPrototype2","_Utils","obj","__esModule","_defineProperty","key","enumerable","configurable","writable","_toConsumableArray","arr2","from","node","props","rendered","className","classes","String","replace","indexOf","tree","fn","forEach","results","root","targetNode","pathFilter","path","filter","queue","hasNode","testNode","current","pop","children","apply","reverse","id","CAN_NEVER_MATCH","replaceUndefined","v","replaceUndefinedValues","reduce","acc","_ref","_ref2","k","type","displayName","map","join"],"mappings":"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","file":"RSTTraversal.js","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.nodeHasProperty = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.propsOfNode = propsOfNode;\nexports.childrenOfNode = childrenOfNode;\nexports.hasClassName = hasClassName;\nexports.treeForEach = treeForEach;\nexports.treeFilter = treeFilter;\nexports.findParentNode = findParentNode;\nexports.pathToNode = pathToNode;\nexports.parentsOfNode = parentsOfNode;\nexports.nodeHasId = nodeHasId;\nexports.nodeMatchesObjectProps = nodeMatchesObjectProps;\nexports.getTextFromNode = getTextFromNode;\n\nvar _object = require('object.assign');\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _flatten = require('lodash/flatten');\n\nvar _flatten2 = _interopRequireDefault(_flatten);\n\nvar _object3 = require('object.entries');\n\nvar _object4 = _interopRequireDefault(_object3);\n\nvar _isSubset = require('is-subset');\n\nvar _isSubset2 = _interopRequireDefault(_isSubset);\n\nvar _functionPrototype = require('function.prototype.name');\n\nvar _functionPrototype2 = _interopRequireDefault(_functionPrototype);\n\nvar _Utils = require('./Utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction propsOfNode(node) {\n  return node && node.props || {};\n}\n\nfunction childrenOfNode(node) {\n  if (!node) return [];\n  return Array.isArray(node.rendered) ? (0, _flatten2['default'])(node.rendered, true) : [node.rendered];\n}\n\nfunction hasClassName(node, className) {\n  var classes = propsOfNode(node).className || '';\n  classes = String(classes).replace(/\\s/g, ' ');\n  return (' ' + String(classes) + ' ').indexOf(' ' + String(className) + ' ') > -1;\n}\n\nfunction treeForEach(tree, fn) {\n  if (tree !== null && tree !== false && typeof tree !== 'undefined') {\n    fn(tree);\n  }\n  childrenOfNode(tree).forEach(function (node) {\n    return treeForEach(node, fn);\n  });\n}\n\nfunction treeFilter(tree, fn) {\n  var results = [];\n  treeForEach(tree, function (node) {\n    if (fn(node)) {\n      results.push(node);\n    }\n  });\n  return results;\n}\n\n/**\n * To support sibling selectors we need to be able to find\n * the siblings of a node. The easiest way to do that is find\n * the parent of the node and access its children.\n *\n * This would be unneeded if the RST spec included sibling pointers\n * such as node.nextSibling and node.prevSibling\n * @param {*} root\n * @param {*} targetNode\n */\nfunction findParentNode(root, targetNode) {\n  var results = treeFilter(root, function (node) {\n    if (!node.rendered) {\n      return false;\n    }\n    return Array.isArray(node.rendered) ? node.rendered.indexOf(targetNode) !== -1 : node.rendered === targetNode;\n  });\n  return results[0] || null;\n}\n\nfunction pathFilter(path, fn) {\n  return path.filter(function (tree) {\n    return treeFilter(tree, fn).length !== 0;\n  });\n}\n\nfunction pathToNode(node, root) {\n  var queue = [root];\n  var path = [];\n\n  var hasNode = function hasNode(testNode) {\n    return node === testNode;\n  };\n\n  while (queue.length) {\n    var current = queue.pop();\n    var children = childrenOfNode(current);\n    if (current === node) return pathFilter(path, hasNode);\n\n    path.push(current);\n\n    if (children.length === 0) {\n      // leaf node. if it isn't the node we are looking for, we pop.\n      path.pop();\n    }\n    queue.push.apply(queue, _toConsumableArray(children));\n  }\n\n  return null;\n}\n\nfunction parentsOfNode(node, root) {\n  return pathToNode(node, root).reverse();\n}\n\nfunction nodeHasId(node, id) {\n  return propsOfNode(node).id === id;\n}\n\nexports.nodeHasProperty = _Utils.nodeHasProperty;\n\n\nvar CAN_NEVER_MATCH = {};\nfunction replaceUndefined(v) {\n  return typeof v !== 'undefined' ? v : CAN_NEVER_MATCH;\n}\nfunction replaceUndefinedValues(obj) {\n  return (0, _object4['default'])(obj).reduce(function (acc, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        k = _ref2[0],\n        v = _ref2[1];\n\n    return (0, _object2['default'])({}, acc, _defineProperty({}, k, replaceUndefined(v)));\n  }, {});\n}\n\nfunction nodeMatchesObjectProps(node, props) {\n  return (0, _isSubset2['default'])(propsOfNode(node), replaceUndefinedValues(props));\n}\n\nfunction getTextFromNode(node) {\n  if (node == null) {\n    return '';\n  }\n\n  if (typeof node === 'string' || typeof node === 'number') {\n    return String(node);\n  }\n\n  if (node.type && typeof node.type === 'function') {\n    return '<' + String(node.type.displayName || (0, _functionPrototype2['default'])(node.type)) + ' />';\n  }\n\n  return childrenOfNode(node).map(getTextFromNode).join('');\n}"]}