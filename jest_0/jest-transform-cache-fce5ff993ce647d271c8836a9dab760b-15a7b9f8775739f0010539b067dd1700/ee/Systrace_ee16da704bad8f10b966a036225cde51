29504e5781705164466358180e4e5b01
'use strict';var invariant=require('fbjs/lib/invariant');var TRACE_TAG_REACT_APPS=1<<17;var TRACE_TAG_JS_VM_CALLS=1<<27;var _enabled=false;var _asyncCookie=0;var _markStack=[];var _markStackIndex=-1;var _canInstallReactHook=false;var _useFiber=false;var REACT_MARKER='\u269B';var userTimingPolyfill=__DEV__?{mark:function mark(markName){if(_enabled){_markStackIndex++;_markStack[_markStackIndex]=markName;var systraceLabel=markName;if(markName[0]===REACT_MARKER){var indexOfId=markName.lastIndexOf(' (#');var cutoffIndex=indexOfId!==-1?indexOfId:markName.length;systraceLabel=markName.slice(2,cutoffIndex);}Systrace.beginEvent(systraceLabel);}},measure:function measure(measureName,startMark,endMark){if(_enabled){invariant(typeof measureName==='string'&&typeof startMark==='string'&&typeof endMark==='undefined','Only performance.measure(string, string) overload is supported.');var topMark=_markStack[_markStackIndex];invariant(startMark===topMark,'There was a mismatching performance.measure() call. '+'Expected "%s" but got "%s."',topMark,startMark);_markStackIndex--;Systrace.endEvent();}},clearMarks:function clearMarks(markName){if(_enabled){if(_markStackIndex===-1){return;}if(markName===_markStack[_markStackIndex]){if(userTimingPolyfill!=null){userTimingPolyfill.measure(markName,markName);}}}},clearMeasures:function clearMeasures(){}}:null;var reactDebugToolHook=__DEV__?{onBeforeMountComponent:function onBeforeMountComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.mountComponent('+displayName+')');},onMountComponent:function onMountComponent(debugID){Systrace.endEvent();},onBeforeUpdateComponent:function onBeforeUpdateComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.updateComponent('+displayName+')');},onUpdateComponent:function onUpdateComponent(debugID){Systrace.endEvent();},onBeforeUnmountComponent:function onBeforeUnmountComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.unmountComponent('+displayName+')');},onUnmountComponent:function onUnmountComponent(debugID){Systrace.endEvent();},onBeginLifeCycleTimer:function onBeginLifeCycleTimer(debugID,timerType){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent(displayName+'.'+timerType+'()');},onEndLifeCycleTimer:function onEndLifeCycleTimer(debugID,timerType){Systrace.endEvent();}}:null;var Systrace={installReactHook:function installReactHook(useFiber){if(_enabled){if(__DEV__){if(useFiber){global.performance=userTimingPolyfill;}else{require('ReactDebugTool').addHook(reactDebugToolHook);}}}_useFiber=useFiber;_canInstallReactHook=true;},setEnabled:function setEnabled(enabled){if(_enabled!==enabled){if(__DEV__){if(enabled){global.nativeTraceBeginLegacy&&global.nativeTraceBeginLegacy(TRACE_TAG_JS_VM_CALLS);}else{global.nativeTraceEndLegacy&&global.nativeTraceEndLegacy(TRACE_TAG_JS_VM_CALLS);}if(_canInstallReactHook){if(_useFiber){if(enabled&&global.performance===undefined){global.performance=userTimingPolyfill;}}else{var ReactDebugTool=require('ReactDebugTool');if(enabled){ReactDebugTool.addHook(reactDebugToolHook);}else{ReactDebugTool.removeHook(reactDebugToolHook);}}}}_enabled=enabled;}},isEnabled:function isEnabled(){return _enabled;},beginEvent:function beginEvent(profileName,args){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceBeginSection(TRACE_TAG_REACT_APPS,profileName,args);}},endEvent:function endEvent(){if(_enabled){global.nativeTraceEndSection(TRACE_TAG_REACT_APPS);}},beginAsyncEvent:function beginAsyncEvent(profileName){var cookie=_asyncCookie;if(_enabled){_asyncCookie++;profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceBeginAsyncSection(TRACE_TAG_REACT_APPS,profileName,cookie);}return cookie;},endAsyncEvent:function endAsyncEvent(profileName,cookie){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceEndAsyncSection(TRACE_TAG_REACT_APPS,profileName,cookie);}},counterEvent:function counterEvent(profileName,value){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceCounter&&global.nativeTraceCounter(TRACE_TAG_REACT_APPS,profileName,value);}},attachToRelayProfiler:function attachToRelayProfiler(relayProfiler){relayProfiler.attachProfileHandler('*',function(name){var cookie=Systrace.beginAsyncEvent(name);return function(){Systrace.endAsyncEvent(name,cookie);};});relayProfiler.attachAggregateHandler('*',function(name,callback){Systrace.beginEvent(name);callback();Systrace.endEvent();});},swizzleJSON:function swizzleJSON(){Systrace.measureMethods(JSON,'JSON',['parse','stringify']);},measureMethods:function measureMethods(object,objectName,methodNames){if(!__DEV__){return;}methodNames.forEach(function(methodName){object[methodName]=Systrace.measure(objectName,methodName,object[methodName]);});},measure:function measure(objName,fnName,func){if(!__DEV__){return func;}var profileName=objName+'.'+fnName;return function(){if(!_enabled){return func.apply(this,arguments);}Systrace.beginEvent(profileName);var ret=func.apply(this,arguments);Systrace.endEvent();return ret;};}};if(__DEV__){require.Systrace=Systrace;}module.exports=Systrace;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN5c3RyYWNlLmpzIl0sIm5hbWVzIjpbImludmFyaWFudCIsInJlcXVpcmUiLCJUUkFDRV9UQUdfUkVBQ1RfQVBQUyIsIlRSQUNFX1RBR19KU19WTV9DQUxMUyIsIl9lbmFibGVkIiwiX2FzeW5jQ29va2llIiwiX21hcmtTdGFjayIsIl9tYXJrU3RhY2tJbmRleCIsIl9jYW5JbnN0YWxsUmVhY3RIb29rIiwiX3VzZUZpYmVyIiwiUkVBQ1RfTUFSS0VSIiwidXNlclRpbWluZ1BvbHlmaWxsIiwiX19ERVZfXyIsIm1hcmsiLCJtYXJrTmFtZSIsInN5c3RyYWNlTGFiZWwiLCJpbmRleE9mSWQiLCJsYXN0SW5kZXhPZiIsImN1dG9mZkluZGV4IiwibGVuZ3RoIiwic2xpY2UiLCJTeXN0cmFjZSIsImJlZ2luRXZlbnQiLCJtZWFzdXJlIiwibWVhc3VyZU5hbWUiLCJzdGFydE1hcmsiLCJlbmRNYXJrIiwidG9wTWFyayIsImVuZEV2ZW50IiwiY2xlYXJNYXJrcyIsImNsZWFyTWVhc3VyZXMiLCJyZWFjdERlYnVnVG9vbEhvb2siLCJvbkJlZm9yZU1vdW50Q29tcG9uZW50IiwiZGVidWdJRCIsIlJlYWN0Q29tcG9uZW50VHJlZUhvb2siLCJkaXNwbGF5TmFtZSIsImdldERpc3BsYXlOYW1lIiwib25Nb3VudENvbXBvbmVudCIsIm9uQmVmb3JlVXBkYXRlQ29tcG9uZW50Iiwib25VcGRhdGVDb21wb25lbnQiLCJvbkJlZm9yZVVubW91bnRDb21wb25lbnQiLCJvblVubW91bnRDb21wb25lbnQiLCJvbkJlZ2luTGlmZUN5Y2xlVGltZXIiLCJ0aW1lclR5cGUiLCJvbkVuZExpZmVDeWNsZVRpbWVyIiwiaW5zdGFsbFJlYWN0SG9vayIsInVzZUZpYmVyIiwiZ2xvYmFsIiwicGVyZm9ybWFuY2UiLCJhZGRIb29rIiwic2V0RW5hYmxlZCIsImVuYWJsZWQiLCJuYXRpdmVUcmFjZUJlZ2luTGVnYWN5IiwibmF0aXZlVHJhY2VFbmRMZWdhY3kiLCJ1bmRlZmluZWQiLCJSZWFjdERlYnVnVG9vbCIsInJlbW92ZUhvb2siLCJpc0VuYWJsZWQiLCJwcm9maWxlTmFtZSIsImFyZ3MiLCJuYXRpdmVUcmFjZUJlZ2luU2VjdGlvbiIsIm5hdGl2ZVRyYWNlRW5kU2VjdGlvbiIsImJlZ2luQXN5bmNFdmVudCIsImNvb2tpZSIsIm5hdGl2ZVRyYWNlQmVnaW5Bc3luY1NlY3Rpb24iLCJlbmRBc3luY0V2ZW50IiwibmF0aXZlVHJhY2VFbmRBc3luY1NlY3Rpb24iLCJjb3VudGVyRXZlbnQiLCJ2YWx1ZSIsIm5hdGl2ZVRyYWNlQ291bnRlciIsImF0dGFjaFRvUmVsYXlQcm9maWxlciIsInJlbGF5UHJvZmlsZXIiLCJhdHRhY2hQcm9maWxlSGFuZGxlciIsIm5hbWUiLCJhdHRhY2hBZ2dyZWdhdGVIYW5kbGVyIiwiY2FsbGJhY2siLCJzd2l6emxlSlNPTiIsIm1lYXN1cmVNZXRob2RzIiwiSlNPTiIsIm9iamVjdCIsIm9iamVjdE5hbWUiLCJtZXRob2ROYW1lcyIsImZvckVhY2giLCJtZXRob2ROYW1lIiwib2JqTmFtZSIsImZuTmFtZSIsImZ1bmMiLCJhcHBseSIsImFyZ3VtZW50cyIsInJldCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQVdBLGFBRUEsR0FBTUEsV0FBWUMsT0FBWixzQkFBTixDQWVBLEdBQU1DLHNCQUF1QixHQUFLLEVBQWxDLENBQ0EsR0FBTUMsdUJBQXdCLEdBQUssRUFBbkMsQ0FFQSxHQUFJQyxVQUFXLEtBQWYsQ0FDQSxHQUFJQyxjQUFlLENBQW5CLENBQ0EsR0FBTUMsWUFBYSxFQUFuQixDQUNBLEdBQUlDLGlCQUFrQixDQUFDLENBQXZCLENBQ0EsR0FBSUMsc0JBQXVCLEtBQTNCLENBQ0EsR0FBSUMsV0FBWSxLQUFoQixDQUlBLEdBQU1DLGNBQWUsUUFBckIsQ0FDQSxHQUFNQyxvQkFBcUJDLFFBQVUsQ0FDbkNDLElBRG1DLGVBQzlCQyxRQUQ4QixDQUNaLENBQ3JCLEdBQUlWLFFBQUosQ0FBYyxDQUNaRyxrQkFDQUQsV0FBV0MsZUFBWCxFQUE4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Q0E4SmhCNUQsT0E5SmdCLGtCQThKUjZELE9BOUpRLENBOEpTQyxNQTlKVCxDQThKeUJDLElBOUp6QixDQThKeUMsQ0FDdkQsR0FBSSxDQUFDMUUsT0FBTCxDQUFjLENBQ1osTUFBTzBFLEtBQVAsQ0FDRCxDQUVELEdBQU01QixhQUFpQjBCLE9BQWpCLEtBQTRCQyxNQUFsQyxDQUNBLE1BQU8sV0FBVyxDQUNoQixHQUFJLENBQUNqRixRQUFMLENBQWUsQ0FDYixNQUFPa0YsTUFBS0MsS0FBTCxDQUFXLElBQVgsQ0FBaUJDLFNBQWpCLENBQVAsQ0FDRCxDQUVEbkUsU0FBU0MsVUFBVCxDQUFvQm9DLFdBQXBCLEVBQ0EsR0FBTStCLEtBQU1ILEtBQUtDLEtBQUwsQ0FBVyxJQUFYLENBQWlCQyxTQUFqQixDQUFaLENBQ0FuRSxTQUFTTyxRQUFULEdBQ0EsTUFBTzZELElBQVAsQ0FDRCxDQVRELENBVUQsQ0E5S2UsQ0FBakIsQ0FpTEEsR0FBSTdFLE9BQUosQ0FBYSxDQUtWWCxPQUFELENBQWVvQixRQUFmLENBQTBCQSxRQUExQixDQUNELENBRURxRSxPQUFPQyxPQUFQLENBQWlCdEUsUUFBakIiLCJmaWxlIjoiU3lzdHJhY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIFN5c3RyYWNlXG4gKiBAZmxvd1xuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuXG50eXBlIFJlbGF5UHJvZmlsZXIgPSB7XG4gIGF0dGFjaFByb2ZpbGVIYW5kbGVyKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICBoYW5kbGVyOiAobmFtZTogc3RyaW5nLCBzdGF0ZT86IGFueSkgPT4gKCkgPT4gdm9pZFxuICApOiB2b2lkLFxuXG4gIGF0dGFjaEFnZ3JlZ2F0ZUhhbmRsZXIoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIGhhbmRsZXI6IChuYW1lOiBzdHJpbmcsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKSA9PiB2b2lkXG4gICk6IHZvaWQsXG59O1xuXG4vKiBlc2xpbnQgbm8tYml0d2lzZTogMCAqL1xuY29uc3QgVFJBQ0VfVEFHX1JFQUNUX0FQUFMgPSAxIDw8IDE3O1xuY29uc3QgVFJBQ0VfVEFHX0pTX1ZNX0NBTExTID0gMSA8PCAyNztcblxubGV0IF9lbmFibGVkID0gZmFsc2U7XG5sZXQgX2FzeW5jQ29va2llID0gMDtcbmNvbnN0IF9tYXJrU3RhY2sgPSBbXTtcbmxldCBfbWFya1N0YWNrSW5kZXggPSAtMTtcbmxldCBfY2FuSW5zdGFsbFJlYWN0SG9vayA9IGZhbHNlO1xubGV0IF91c2VGaWJlciA9IGZhbHNlO1xuXG4vLyBJbXBsZW1lbnRzIGEgc3Vic2V0IG9mIFVzZXIgVGltaW5nIEFQSSBuZWNlc3NhcnkgZm9yIFJlYWN0IG1lYXN1cmVtZW50cy5cbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9Vc2VyX1RpbWluZ19BUElcbmNvbnN0IFJFQUNUX01BUktFUiA9ICdcXHUyNjlCJztcbmNvbnN0IHVzZXJUaW1pbmdQb2x5ZmlsbCA9IF9fREVWX18gPyB7XG4gIG1hcmsobWFya05hbWU6IHN0cmluZykge1xuICAgIGlmIChfZW5hYmxlZCkge1xuICAgICAgX21hcmtTdGFja0luZGV4Kys7XG4gICAgICBfbWFya1N0YWNrW19tYXJrU3RhY2tJbmRleF0gPSBtYXJrTmFtZTtcbiAgICAgIGxldCBzeXN0cmFjZUxhYmVsID0gbWFya05hbWU7XG4gICAgICAvLyBTaW5jZSBwZXJmIG1lYXN1cmVtZW50cyBhcmUgYSBzaGFyZWQgbmFtZXNwYWNlIGluIFVzZXIgVGltaW5nIEFQSSxcbiAgICAgIC8vIHdlIHByZWZpeCBhbGwgUmVhY3QgcmVzdWx0cyB3aXRoIGEgUmVhY3QgZW1vamkuXG4gICAgICBpZiAobWFya05hbWVbMF0gPT09IFJFQUNUX01BUktFUikge1xuICAgICAgICAvLyBUaGlzIGlzIGNvbWluZyBmcm9tIFJlYWN0LlxuICAgICAgICAvLyBSZW1vdmluZyBjb21wb25lbnQgSURzIGtlZXBzIHRyYWNlIGNvbG9ycyBzdGFibGUuXG4gICAgICAgIGNvbnN0IGluZGV4T2ZJZCA9IG1hcmtOYW1lLmxhc3RJbmRleE9mKCcgKCMnKTtcbiAgICAgICAgY29uc3QgY3V0b2ZmSW5kZXggPSBpbmRleE9mSWQgIT09IC0xID8gaW5kZXhPZklkIDogbWFya05hbWUubGVuZ3RoO1xuICAgICAgICAvLyBBbHNvIGN1dCBvZmYgdGhlIGVtb2ppIGJlY2F1c2UgaXQgYnJlYWtzIFN5c3RyYWNlXG4gICAgICAgIHN5c3RyYWNlTGFiZWwgPSBtYXJrTmFtZS5zbGljZSgyLCBjdXRvZmZJbmRleCk7XG4gICAgICB9XG4gICAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KHN5c3RyYWNlTGFiZWwpO1xuICAgIH1cbiAgfSxcbiAgbWVhc3VyZShtZWFzdXJlTmFtZTogc3RyaW5nLCBzdGFydE1hcms6ID9zdHJpbmcsIGVuZE1hcms6ID9zdHJpbmcpIHtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgdHlwZW9mIG1lYXN1cmVOYW1lID09PSAnc3RyaW5nJyAmJlxuICAgICAgICB0eXBlb2Ygc3RhcnRNYXJrID09PSAnc3RyaW5nJyAmJlxuICAgICAgICB0eXBlb2YgZW5kTWFyayA9PT0gJ3VuZGVmaW5lZCcsXG4gICAgICAgICdPbmx5IHBlcmZvcm1hbmNlLm1lYXN1cmUoc3RyaW5nLCBzdHJpbmcpIG92ZXJsb2FkIGlzIHN1cHBvcnRlZC4nXG4gICAgICApO1xuICAgICAgY29uc3QgdG9wTWFyayA9IF9tYXJrU3RhY2tbX21hcmtTdGFja0luZGV4XTtcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgc3RhcnRNYXJrID09PSB0b3BNYXJrLFxuICAgICAgICAnVGhlcmUgd2FzIGEgbWlzbWF0Y2hpbmcgcGVyZm9ybWFuY2UubWVhc3VyZSgpIGNhbGwuICcgK1xuICAgICAgICAnRXhwZWN0ZWQgXCIlc1wiIGJ1dCBnb3QgXCIlcy5cIicsXG4gICAgICAgIHRvcE1hcmssXG4gICAgICAgIHN0YXJ0TWFyayxcbiAgICAgICk7XG4gICAgICBfbWFya1N0YWNrSW5kZXgtLTtcbiAgICAgIC8vIFdlIGNhbid0IHVzZSBtb3JlIGRlc2NyaXB0aXZlIG1lYXN1cmVOYW1lIGJlY2F1c2UgU3lzdHJhY2UgZG9lc24ndFxuICAgICAgLy8gbGV0IHVzIGVkaXQgbGFiZWxzIHBvc3QgZmFjdHVtLlxuICAgICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgICB9XG4gIH0sXG4gIGNsZWFyTWFya3MobWFya05hbWU6IHN0cmluZykge1xuICAgIGlmIChfZW5hYmxlZCkge1xuICAgICAgaWYgKF9tYXJrU3RhY2tJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKG1hcmtOYW1lID09PSBfbWFya1N0YWNrW19tYXJrU3RhY2tJbmRleF0pIHtcbiAgICAgICAgLy8gUmVhY3QgdXNlcyB0aGlzIGZvciBcImNhbmNlbGxpbmdcIiBzdGFydGVkIG1lYXN1cmVtZW50cy5cbiAgICAgICAgLy8gU3lzdHJhY2UgZG9lc24ndCBzdXBwb3J0IGRlbGV0aW5nIG1lYXN1cmVtZW50cywgc28gd2UganVzdCBzdG9wIHRoZW0uXG4gICAgICAgIGlmICh1c2VyVGltaW5nUG9seWZpbGwgIT0gbnVsbCkge1xuICAgICAgICAgIHVzZXJUaW1pbmdQb2x5ZmlsbC5tZWFzdXJlKG1hcmtOYW1lLCBtYXJrTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGNsZWFyTWVhc3VyZXMoKSB7XG4gICAgLy8gUmVhY3QgY2FsbHMgdGhpcyB0byBhdm9pZCBtZW1vcnkgbGVha3MgaW4gYnJvd3NlcnMsIGJ1dCB3ZSBkb24ndCBrZWVwXG4gICAgLy8gbWVhc3VyZW1lbnRzIGFueXdheS5cbiAgfSxcbn0gOiBudWxsO1xuXG4vLyBBIGhvb2sgdG8gZ2V0IFJlYWN0IFN0YWNrIG1hcmtlcnMgaW4gU3lzdHJhY2UuXG5jb25zdCByZWFjdERlYnVnVG9vbEhvb2sgPSBfX0RFVl9fID8ge1xuICBvbkJlZm9yZU1vdW50Q29tcG9uZW50KGRlYnVnSUQpIHtcbiAgICBjb25zdCBSZWFjdENvbXBvbmVudFRyZWVIb29rID0gcmVxdWlyZSgnUmVhY3RHbG9iYWxTaGFyZWRTdGF0ZScpLlJlYWN0Q29tcG9uZW50VHJlZUhvb2s7XG4gICAgY29uc3QgZGlzcGxheU5hbWUgPSBSZWFjdENvbXBvbmVudFRyZWVIb29rLmdldERpc3BsYXlOYW1lKGRlYnVnSUQpO1xuICAgIFN5c3RyYWNlLmJlZ2luRXZlbnQoYFJlYWN0UmVjb25jaWxlci5tb3VudENvbXBvbmVudCgke2Rpc3BsYXlOYW1lfSlgKTtcbiAgfSxcbiAgb25Nb3VudENvbXBvbmVudChkZWJ1Z0lEKSB7XG4gICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgfSxcbiAgb25CZWZvcmVVcGRhdGVDb21wb25lbnQoZGVidWdJRCkge1xuICAgIGNvbnN0IFJlYWN0Q29tcG9uZW50VHJlZUhvb2sgPSByZXF1aXJlKCdSZWFjdEdsb2JhbFNoYXJlZFN0YXRlJykuUmVhY3RDb21wb25lbnRUcmVlSG9vaztcbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IFJlYWN0Q29tcG9uZW50VHJlZUhvb2suZ2V0RGlzcGxheU5hbWUoZGVidWdJRCk7XG4gICAgU3lzdHJhY2UuYmVnaW5FdmVudChgUmVhY3RSZWNvbmNpbGVyLnVwZGF0ZUNvbXBvbmVudCgke2Rpc3BsYXlOYW1lfSlgKTtcbiAgfSxcbiAgb25VcGRhdGVDb21wb25lbnQoZGVidWdJRCkge1xuICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gIH0sXG4gIG9uQmVmb3JlVW5tb3VudENvbXBvbmVudChkZWJ1Z0lEKSB7XG4gICAgY29uc3QgUmVhY3RDb21wb25lbnRUcmVlSG9vayA9IHJlcXVpcmUoJ1JlYWN0R2xvYmFsU2hhcmVkU3RhdGUnKS5SZWFjdENvbXBvbmVudFRyZWVIb29rO1xuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gUmVhY3RDb21wb25lbnRUcmVlSG9vay5nZXREaXNwbGF5TmFtZShkZWJ1Z0lEKTtcbiAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KGBSZWFjdFJlY29uY2lsZXIudW5tb3VudENvbXBvbmVudCgke2Rpc3BsYXlOYW1lfSlgKTtcbiAgfSxcbiAgb25Vbm1vdW50Q29tcG9uZW50KGRlYnVnSUQpIHtcbiAgICBTeXN0cmFjZS5lbmRFdmVudCgpO1xuICB9LFxuICBvbkJlZ2luTGlmZUN5Y2xlVGltZXIoZGVidWdJRCwgdGltZXJUeXBlKSB7XG4gICAgY29uc3QgUmVhY3RDb21wb25lbnRUcmVlSG9vayA9IHJlcXVpcmUoJ1JlYWN0R2xvYmFsU2hhcmVkU3RhdGUnKS5SZWFjdENvbXBvbmVudFRyZWVIb29rO1xuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gUmVhY3RDb21wb25lbnRUcmVlSG9vay5nZXREaXNwbGF5TmFtZShkZWJ1Z0lEKTtcbiAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KGAke2Rpc3BsYXlOYW1lfS4ke3RpbWVyVHlwZX0oKWApO1xuICB9LFxuICBvbkVuZExpZmVDeWNsZVRpbWVyKGRlYnVnSUQsIHRpbWVyVHlwZSkge1xuICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gIH0sXG59IDogbnVsbDtcblxuY29uc3QgU3lzdHJhY2UgPSB7XG4gIGluc3RhbGxSZWFjdEhvb2sodXNlRmliZXI6IGJvb2xlYW4pIHtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAgIGlmICh1c2VGaWJlcikge1xuICAgICAgICAgIGdsb2JhbC5wZXJmb3JtYW5jZSA9IHVzZXJUaW1pbmdQb2x5ZmlsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXF1aXJlKCdSZWFjdERlYnVnVG9vbCcpLmFkZEhvb2socmVhY3REZWJ1Z1Rvb2xIb29rKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBfdXNlRmliZXIgPSB1c2VGaWJlcjtcbiAgICBfY2FuSW5zdGFsbFJlYWN0SG9vayA9IHRydWU7XG4gIH0sXG5cbiAgc2V0RW5hYmxlZChlbmFibGVkOiBib29sZWFuKSB7XG4gICAgaWYgKF9lbmFibGVkICE9PSBlbmFibGVkKSB7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBpZiAoZW5hYmxlZCkge1xuICAgICAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUJlZ2luTGVnYWN5ICYmIGdsb2JhbC5uYXRpdmVUcmFjZUJlZ2luTGVnYWN5KFRSQUNFX1RBR19KU19WTV9DQUxMUyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ2xvYmFsLm5hdGl2ZVRyYWNlRW5kTGVnYWN5ICYmIGdsb2JhbC5uYXRpdmVUcmFjZUVuZExlZ2FjeShUUkFDRV9UQUdfSlNfVk1fQ0FMTFMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfY2FuSW5zdGFsbFJlYWN0SG9vaykge1xuICAgICAgICAgIGlmIChfdXNlRmliZXIpIHtcbiAgICAgICAgICAgIGlmIChlbmFibGVkICYmIGdsb2JhbC5wZXJmb3JtYW5jZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGdsb2JhbC5wZXJmb3JtYW5jZSA9IHVzZXJUaW1pbmdQb2x5ZmlsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgUmVhY3REZWJ1Z1Rvb2wgPSByZXF1aXJlKCdSZWFjdERlYnVnVG9vbCcpO1xuICAgICAgICAgICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgUmVhY3REZWJ1Z1Rvb2wuYWRkSG9vayhyZWFjdERlYnVnVG9vbEhvb2spO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgUmVhY3REZWJ1Z1Rvb2wucmVtb3ZlSG9vayhyZWFjdERlYnVnVG9vbEhvb2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgX2VuYWJsZWQgPSBlbmFibGVkO1xuICAgIH1cbiAgfSxcblxuICBpc0VuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIF9lbmFibGVkO1xuICB9LFxuXG4gIC8qKlxuICAgKiBiZWdpbkV2ZW50L2VuZEV2ZW50IGZvciBzdGFydGluZyBhbmQgdGhlbiBlbmRpbmcgYSBwcm9maWxlIHdpdGhpbiB0aGUgc2FtZSBjYWxsIHN0YWNrIGZyYW1lXG4gICoqL1xuICBiZWdpbkV2ZW50KHByb2ZpbGVOYW1lPzogYW55LCBhcmdzPzogYW55KSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBwcm9maWxlTmFtZSA9IHR5cGVvZiBwcm9maWxlTmFtZSA9PT0gJ2Z1bmN0aW9uJyA/XG4gICAgICAgIHByb2ZpbGVOYW1lKCkgOiBwcm9maWxlTmFtZTtcbiAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUJlZ2luU2VjdGlvbihUUkFDRV9UQUdfUkVBQ1RfQVBQUywgcHJvZmlsZU5hbWUsIGFyZ3MpO1xuICAgIH1cbiAgfSxcblxuICBlbmRFdmVudCgpIHtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUVuZFNlY3Rpb24oVFJBQ0VfVEFHX1JFQUNUX0FQUFMpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogYmVnaW5Bc3luY0V2ZW50L2VuZEFzeW5jRXZlbnQgZm9yIHN0YXJ0aW5nIGFuZCB0aGVuIGVuZGluZyBhIHByb2ZpbGUgd2hlcmUgdGhlIGVuZCBjYW4gZWl0aGVyXG4gICAqIG9jY3VyIG9uIGFub3RoZXIgdGhyZWFkIG9yIG91dCBvZiB0aGUgY3VycmVudCBzdGFjayBmcmFtZSwgZWcgYXdhaXRcbiAgICogdGhlIHJldHVybmVkIGNvb2tpZSB2YXJpYWJsZSBzaG91bGQgYmUgdXNlZCBhcyBpbnB1dCBpbnRvIHRoZSBlbmRBc3luY0V2ZW50IGNhbGwgdG8gZW5kIHRoZSBwcm9maWxlXG4gICoqL1xuICBiZWdpbkFzeW5jRXZlbnQocHJvZmlsZU5hbWU/OiBhbnkpOiBhbnkge1xuICAgIGNvbnN0IGNvb2tpZSA9IF9hc3luY0Nvb2tpZTtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIF9hc3luY0Nvb2tpZSsrO1xuICAgICAgcHJvZmlsZU5hbWUgPSB0eXBlb2YgcHJvZmlsZU5hbWUgPT09ICdmdW5jdGlvbicgP1xuICAgICAgICBwcm9maWxlTmFtZSgpIDogcHJvZmlsZU5hbWU7XG4gICAgICBnbG9iYWwubmF0aXZlVHJhY2VCZWdpbkFzeW5jU2VjdGlvbihUUkFDRV9UQUdfUkVBQ1RfQVBQUywgcHJvZmlsZU5hbWUsIGNvb2tpZSk7XG4gICAgfVxuICAgIHJldHVybiBjb29raWU7XG4gIH0sXG5cbiAgZW5kQXN5bmNFdmVudChwcm9maWxlTmFtZT86IGFueSwgY29va2llPzogYW55KSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBwcm9maWxlTmFtZSA9IHR5cGVvZiBwcm9maWxlTmFtZSA9PT0gJ2Z1bmN0aW9uJyA/XG4gICAgICAgIHByb2ZpbGVOYW1lKCkgOiBwcm9maWxlTmFtZTtcbiAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUVuZEFzeW5jU2VjdGlvbihUUkFDRV9UQUdfUkVBQ1RfQVBQUywgcHJvZmlsZU5hbWUsIGNvb2tpZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBjb3VudGVyRXZlbnQgcmVnaXN0ZXJzIHRoZSB2YWx1ZSB0byB0aGUgcHJvZmlsZU5hbWUgb24gdGhlIHN5c3RyYWNlIHRpbWVsaW5lXG4gICoqL1xuICBjb3VudGVyRXZlbnQocHJvZmlsZU5hbWU/OiBhbnksIHZhbHVlPzogYW55KSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBwcm9maWxlTmFtZSA9IHR5cGVvZiBwcm9maWxlTmFtZSA9PT0gJ2Z1bmN0aW9uJyA/XG4gICAgICAgIHByb2ZpbGVOYW1lKCkgOiBwcm9maWxlTmFtZTtcbiAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUNvdW50ZXIgJiZcbiAgICAgICAgZ2xvYmFsLm5hdGl2ZVRyYWNlQ291bnRlcihUUkFDRV9UQUdfUkVBQ1RfQVBQUywgcHJvZmlsZU5hbWUsIHZhbHVlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbGF5IHByb2ZpbGVzIHVzZSBhd2FpdCBjYWxscywgc28gbGlrZWx5IG9jY3VyIG91dCBvZiBjdXJyZW50IHN0YWNrIGZyYW1lXG4gICAqIHRoZXJlZm9yZSBhc3luYyB2YXJpYW50IG9mIHByb2ZpbGluZyBpcyB1c2VkXG4gICoqL1xuICBhdHRhY2hUb1JlbGF5UHJvZmlsZXIocmVsYXlQcm9maWxlcjogUmVsYXlQcm9maWxlcikge1xuICAgIHJlbGF5UHJvZmlsZXIuYXR0YWNoUHJvZmlsZUhhbmRsZXIoJyonLCAobmFtZSkgPT4ge1xuICAgICAgY29uc3QgY29va2llID0gU3lzdHJhY2UuYmVnaW5Bc3luY0V2ZW50KG5hbWUpO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgU3lzdHJhY2UuZW5kQXN5bmNFdmVudChuYW1lLCBjb29raWUpO1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHJlbGF5UHJvZmlsZXIuYXR0YWNoQWdncmVnYXRlSGFuZGxlcignKicsIChuYW1lLCBjYWxsYmFjaykgPT4ge1xuICAgICAgU3lzdHJhY2UuYmVnaW5FdmVudChuYW1lKTtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgICBTeXN0cmFjZS5lbmRFdmVudCgpO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qIFRoaXMgaXMgbm90IGNhbGxlZCBieSBkZWZhdWx0IGR1ZSB0byBwZXJmIG92ZXJoZWFkIGJ1dCBpdCdzIHVzZWZ1bFxuICAgICBpZiB5b3Ugd2FudCB0byBmaW5kIHRyYWNlcyB3aGljaCBzcGVuZCB0b28gbXVjaCB0aW1lIGluIEpTT04uICovXG4gIHN3aXp6bGVKU09OKCkge1xuICAgIFN5c3RyYWNlLm1lYXN1cmVNZXRob2RzKEpTT04sICdKU09OJywgW1xuICAgICAgJ3BhcnNlJyxcbiAgICAgICdzdHJpbmdpZnknXG4gICAgXSk7XG4gIH0sXG5cbiAvKipcbiAgKiBNZWFzdXJlcyBtdWx0aXBsZSBtZXRob2RzIG9mIGEgY2xhc3MuIEZvciBleGFtcGxlLCB5b3UgY2FuIGRvOlxuICAqIFN5c3RyYWNlLm1lYXN1cmVNZXRob2RzKEpTT04sICdKU09OJywgWydwYXJzZScsICdzdHJpbmdpZnknXSk7XG4gICpcbiAgKiBAcGFyYW0gb2JqZWN0XG4gICogQHBhcmFtIG9iamVjdE5hbWVcbiAgKiBAcGFyYW0gbWV0aG9kTmFtZXMgTWFwIGZyb20gbWV0aG9kIG5hbWVzIHRvIG1ldGhvZCBkaXNwbGF5IG5hbWVzLlxuICAqL1xuIG1lYXN1cmVNZXRob2RzKG9iamVjdDogYW55LCBvYmplY3ROYW1lOiBzdHJpbmcsIG1ldGhvZE5hbWVzOiBBcnJheTxzdHJpbmc+KTogdm9pZCB7XG4gICBpZiAoIV9fREVWX18pIHtcbiAgICAgcmV0dXJuO1xuICAgfVxuXG4gICBtZXRob2ROYW1lcy5mb3JFYWNoKG1ldGhvZE5hbWUgPT4ge1xuICAgICBvYmplY3RbbWV0aG9kTmFtZV0gPSBTeXN0cmFjZS5tZWFzdXJlKFxuICAgICAgIG9iamVjdE5hbWUsXG4gICAgICAgbWV0aG9kTmFtZSxcbiAgICAgICBvYmplY3RbbWV0aG9kTmFtZV1cbiAgICAgKTtcbiAgIH0pO1xuIH0sXG5cbiAvKipcbiAgKiBSZXR1cm5zIGFuIHByb2ZpbGVkIHZlcnNpb24gb2YgdGhlIGlucHV0IGZ1bmN0aW9uLiBGb3IgZXhhbXBsZSwgeW91IGNhbjpcbiAgKiBKU09OLnBhcnNlID0gU3lzdHJhY2UubWVhc3VyZSgnSlNPTicsICdwYXJzZScsIEpTT04ucGFyc2UpO1xuICAqXG4gICogQHBhcmFtIG9iak5hbWVcbiAgKiBAcGFyYW0gZm5OYW1lXG4gICogQHBhcmFtIHtmdW5jdGlvbn0gZnVuY1xuICAqIEByZXR1cm4ge2Z1bmN0aW9ufSByZXBsYWNlbWVudCBmdW5jdGlvblxuICAqL1xuIG1lYXN1cmUob2JqTmFtZTogc3RyaW5nLCBmbk5hbWU6IHN0cmluZywgZnVuYzogYW55KTogYW55IHtcbiAgIGlmICghX19ERVZfXykge1xuICAgICByZXR1cm4gZnVuYztcbiAgIH1cblxuICAgY29uc3QgcHJvZmlsZU5hbWUgPSBgJHtvYmpOYW1lfS4ke2ZuTmFtZX1gO1xuICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICBpZiAoIV9lbmFibGVkKSB7XG4gICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgfVxuXG4gICAgIFN5c3RyYWNlLmJlZ2luRXZlbnQocHJvZmlsZU5hbWUpO1xuICAgICBjb25zdCByZXQgPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gICAgIHJldHVybiByZXQ7XG4gICB9O1xuIH0sXG59O1xuXG5pZiAoX19ERVZfXykge1xuICAvLyBUaGlzIGlzIG5lZWRlZCwgYmVjYXVzZSByZXF1aXJlIGNhbGxpcyBpbiBwb2x5ZmlsbHMgYXJlIG5vdCBwcm9jZXNzZWQgYXNcbiAgLy8gb3RoZXIgZmlsZXMuIFRoZXJlZm9yZSwgY2FsbHMgdG8gYHJlcXVpcmUoJ21vZHVsZUlkJylgIGFyZSBub3QgcmVwbGFjZWRcbiAgLy8gd2l0aCBudW1lcmljIElEc1xuICAvLyBUT0RPKGRhdmlkYXVyZWxpbykgU2NhbiBwb2x5ZmlsbHMgZm9yIGRlcGVuZGVuY2llcywgdG9vICh0OTc1OTY4NilcbiAgKHJlcXVpcmU6IGFueSkuU3lzdHJhY2UgPSBTeXN0cmFjZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTeXN0cmFjZTtcbiJdfQ==